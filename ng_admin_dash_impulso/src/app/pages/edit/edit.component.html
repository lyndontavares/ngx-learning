<md-toolbar color="primary">
    <md-toolbar-row>
    </md-toolbar-row>
</md-toolbar>

<div fxLayout="row" fxLayoutWrap="wrap" fxLayoutAlign="center start">
    <div fxFlex.gt-sm="55" fxFlex="100">
        <md-card class="mat-card-top">
            <md-tab-group md-stretch-tabs>
                <!--<md-tab>
                  <ng-template md-tab-label>Empresa</ng-template>
                  <md-card-content>
                    <form  fxLayout="column">

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="First name">
                      </md-input-container>

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="Last name">
                      </md-input-container>

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="Company">
                      </md-input-container>

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="Email address">
                      </md-input-container>

                      <md-select placeholder="Timezone" class="mb-1">
                        <md-option value="Hawaii">(GMT-10:00) Hawaii</md-option>
                        <md-option value="Alaska">(GMT-09:00) Alaska</md-option>
                        <md-option value="Pacific Time (US & Canada)">(GMT-08:00) Pacific Time (US & Canada)</md-option>
                        <md-option value="Arizona">(GMT-07:00) Arizona</md-option>
                        <md-option value="Mountain Time (US & Canada)">(GMT-07:00) Mountain Time (US & Canada)</md-option>
                        <md-option value="Central Time (US & Canada)" selected="selected">(GMT-06:00) Central Time (US & Canada)</md-option>
                        <md-option value="Eastern Time (US & Canada)">(GMT-05:00) Eastern Time (US & Canada)</md-option>
                        <md-option value="Indiana (East)">(GMT-05:00) Indiana (East)</md-option>
                      </md-select>

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="Username">
                      </md-input-container>

                    </form>
                  </md-card-content>
                </md-tab>
                <md-tab>
                  <ng-template md-tab-label>Perfil</ng-template>
                  <md-card-content>
                    <form  fxLayout="column">

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="First name">
                      </md-input-container>

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="Last name">
                      </md-input-container>

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="Company">
                      </md-input-container>

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="Email address">
                      </md-input-container>

                      <md-select placeholder="Timezone" class="mb-1">
                        <md-option value="Hawaii">(GMT-10:00) Hawaii</md-option>
                        <md-option value="Alaska">(GMT-09:00) Alaska</md-option>
                        <md-option value="Pacific Time (US & Canada)">(GMT-08:00) Pacific Time (US & Canada)</md-option>
                        <md-option value="Arizona">(GMT-07:00) Arizona</md-option>
                        <md-option value="Mountain Time (US & Canada)">(GMT-07:00) Mountain Time (US & Canada)</md-option>
                        <md-option value="Central Time (US & Canada)" selected="selected">(GMT-06:00) Central Time (US & Canada)</md-option>
                        <md-option value="Eastern Time (US & Canada)">(GMT-05:00) Eastern Time (US & Canada)</md-option>
                        <md-option value="Indiana (East)">(GMT-05:00) Indiana (East)</md-option>
                      </md-select>

                      <md-input-container class="mb-1">
                        <input mdInput placeholder="Username">
                      </md-input-container>

                    </form>
                  </md-card-content>
                </md-tab>-->
                <md-tab>
                    <ng-template md-tab-label>Seguridad</ng-template>
                    <md-card-content>
                        <form fxLayout="column" [formGroup]="passwordForm">

                            <md-input-container>
                                <input mdInput placeholder="Contrase単a anterior" type="password"
                                       formControlName="currentPassword">
                            </md-input-container>
                            <small *ngIf="passwordForm.controls['currentPassword'].hasError('required') && passwordForm.controls['currentPassword'].touched"
                                   class="mat-text-warn mb-1">Campo requerido.
                            </small>

                            <md-input-container>
                                <input mdInput placeholder="Nueva contrase単a" type="password"
                                       formControlName="newPassword">
                            </md-input-container>
                            <small *ngIf="passwordForm.controls['newPassword'].hasError('required') && passwordForm.controls['newPassword'].touched"
                                   class="mat-text-warn mb-1">Campo requerido.
                            </small>
                            <small *ngIf="passwordForm.controls['newPassword'] == passwordForm.controls['currentPassword']"
                                   class="mat-text-warn mb-1">La nueva contrase単a debe ser diferente a la actual.
                            </small>

                            <md-input-container>
                                <input mdInput placeholder="Confirmar nueva contrase単a" type="password"
                                       formControlName="repeatPassword">
                            </md-input-container>
                            <small *ngIf="passwordForm.controls['repeatPassword'].hasError('required') && passwordForm.controls['repeatPassword'].touched"
                                   class="mat-text-warn mb-2">Campo requerido.
                            </small>

                            <small class="mat-text-warn mb-0">
                                {{getPasswordMessage()}}
                            </small>
                        </form>
                    </md-card-content>
                </md-tab>
                <md-tab>
                    <ng-template md-tab-label>Preferencias</ng-template>
                    <md-card-content>
                        <md-list>
                            <md-list-item *ngFor="let system of systems">
                                <span fxFlex>{{system.name}}</span>
                                <md-slide-toggle [(ngModel)]="system.on" (change)="changeConfig()"></md-slide-toggle>
                            </md-list-item>
                        </md-list>
                    </md-card-content>
                </md-tab>
            </md-tab-group>
            <hr>
            <md-card-actions>
                <md-progress-bar mode="indeterminate" color="primary" class="mb-1" *ngIf="saving"></md-progress-bar>
                <button *ngIf="!saving" md-raised-button color="primary" (click)="saveConfig()"
                        [disabled]="!formValid() || !formFilled() || !this.passwordForm.valid">Guardar
                </button>
                <a [routerLink]="['/home']" *ngIf="!saving">
                    <button md-raised-button class="shadow-none">Cancelar</button>
                </a>
            </md-card-actions>
        </md-card>
    </div>
</div>